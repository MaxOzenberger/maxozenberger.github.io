import{r as E}from"./earcut.a219bf29.js";import{hf as L,j7 as O}from"./index.3255d2a5.js";import{r as _}from"./deduplicate.97d7ef01.js";function x(n,t=!1){return n<=L?t?new Array(n).fill(0):new Array(n):new Float64Array(n)}function j(n){return length<=L?Array.from(n):new Float64Array(n)}function H(n,t,g){return Array.isArray(n)?n.slice(t,t+g):n.subarray(t,t+g)}function v(n){const t=S(n.rings,n.hasZ,I.CCW_IS_HOLE),g=new Array;let r=0,i=0;for(const o of t.polygons){const a=o.count,s=o.index,y=H(t.position,3*s,3*a),p=o.holeIndices.map(f=>f-s),c=new Uint32Array(E(y,p,3));g.push({position:y,faces:c}),r+=y.length,i+=c.length}const e=N(g,r,i),h=Array.isArray(e.position)?_(e.position,3,{originalIndices:e.faces}):_(e.position.buffer,6,{originalIndices:e.faces});return e.position=new Float64Array(h.buffer),e.faces=h.indices,e}function N(n,t,g){if(n.length===1)return n[0];const r=x(t),i=new Uint32Array(g);let e=0,h=0,o=0;for(const a of n){for(let s=0;s<a.position.length;s++)r[e++]=a.position[s];for(let s=0;s<a.faces.length;s++)i[h++]=a.faces[s]+o;o=e/3}return{position:r,faces:i}}function S(n,t,g){const r=n.length,i=new Array(r),e=new Array(r),h=new Array(r);let o=0,a=0,s=0,y=0;for(let f=0;f<r;++f)y+=n[f].length;const p=x(3*y);let c=0;for(let f=r-1;f>=0;f--){const l=n[f],m=g===I.CCW_IS_HOLE&&W(l);if(m&&r!==1)i[o++]=l;else{let C=l.length;for(let u=0;u<o;++u)C+=i[u].length;const A={index:c,pathLengths:new Array(o+1),count:C,holeIndices:new Array(o)};A.pathLengths[0]=l.length,l.length>0&&(h[s++]={index:c,count:l.length}),c=m?d(l,l.length-1,-1,p,c,l.length,t):d(l,0,1,p,c,l.length,t);for(let u=0;u<o;++u){const w=i[u];A.holeIndices[u]=c,A.pathLengths[u+1]=w.length,w.length>0&&(h[s++]={index:c,count:w.length}),c=d(w,0,1,p,c,w.length,t)}o=0,A.count>0&&(e[a++]=A)}}for(let f=0;f<o;++f){const l=i[f];l.length>0&&(h[s++]={index:c,count:l.length}),c=d(l,0,1,p,c,l.length,t)}return e.length=a,h.length=s,{position:p,polygons:e,outlines:h}}function d(n,t,g,r,i,e,h){i*=3;for(let o=0;o<e;++o){const a=n[t];r[i++]=a[0],r[i++]=a[1],r[i++]=h?a[2]:0,t+=g}return i/3}function W(n){return!O(n,!1,!1)}var I;(function(n){n[n.NONE=0]="NONE",n[n.CCW_IS_HOLE=1]="CCW_IS_HOLE"})(I||(I={}));export{H as a,I as f,v as i,S as l,x as n,j as t};
