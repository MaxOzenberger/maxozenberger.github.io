import{s as Y,hl as O,hj as _,hA as h,fr as g,fq as M,hB as b,hb as j,hC as x,hy as W,hz as q,n as R,t as d,hq as B,hD as S}from"./index.3255d2a5.js";import{e as z}from"./mat3f64.9180efcb.js";import{e as U}from"./mat4f64.9070f685.js";import{c as C}from"./spatialReferenceEllipsoidUtils.7f3e3256.js";import{i as c,T as m}from"./BufferView.32a50625.js";import{t as $,r as V,o as v}from"./vec33.e7ec8171.js";const A=Y.getLogger("esri.geometry.support.meshUtils.normalProjection");function J(r,e,o,f,t){return l(f)?(F(s.TO_PCPF,c.fromTypedArray(r),m.fromTypedArray(e),m.fromTypedArray(o),f,c.fromTypedArray(t)),t):(A.error("Cannot convert spatial reference to PCPF"),t)}function K(r,e,o,f,t){return l(f)?(F(s.FROM_PCPF,c.fromTypedArray(r),m.fromTypedArray(e),m.fromTypedArray(o),f,c.fromTypedArray(t)),t):(A.error("Cannot convert to spatial reference from PCPF"),t)}function Q(r,e,o){return O(r,e,0,o,C(e),0,r.length/3),o}function X(r,e,o){return O(r,C(o),0,e,o,0,r.length/3),e}function rr(r,e,o){if(d(r))return e;const f=m.fromTypedArray(r),t=m.fromTypedArray(e);return $(t,f,o),e}function er(r,e,o){if(d(r))return e;B(n,o);const f=c.fromTypedArray(r),t=c.fromTypedArray(e);return V(t,f,n),S(n)||v(t,t),e}function tr(r,e,o){if(d(r))return e;B(n,o);const f=c.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),t=c.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT);if(V(t,f,n),S(n)||v(t,t),r!==e)for(let a=3;a<r.length;a+=4)e[a]=r[a];return e}function or(r,e,o,f,t){if(!l(f))return A.error("Cannot convert spatial reference to PCPF"),t;F(s.TO_PCPF,c.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),m.fromTypedArray(e),m.fromTypedArray(o),f,c.fromTypedArray(t,4*Float32Array.BYTES_PER_ELEMENT));for(let a=3;a<r.length;a+=4)t[a]=r[a];return t}function fr(r,e,o,f,t){if(!l(f))return A.error("Cannot convert to spatial reference from PCPF"),t;F(s.FROM_PCPF,c.fromTypedArray(r,16),m.fromTypedArray(e),m.fromTypedArray(o),f,c.fromTypedArray(t,16));for(let a=3;a<r.length;a+=4)t[a]=r[a];return t}function F(r,e,o,f,t,a){if(!e)return;const E=o.count,P=C(t);if(L(t))for(let y=0;y<E;y++)f.getVec(y,T),e.getVec(y,i),_(P,T,p,P),h(n,p),r===s.FROM_PCPF&&g(n,n),M(i,i,n),a.setVec(y,i);else for(let y=0;y<E;y++){f.getVec(y,T),e.getVec(y,i),_(P,T,p,P),h(n,p);const N=b(o.get(y,1));let u=Math.cos(N);r===s.TO_PCPF&&(u=1/u),n[0]*=u,n[1]*=u,n[2]*=u,n[3]*=u,n[4]*=u,n[5]*=u,r===s.FROM_PCPF&&g(n,n),M(i,i,n),j(i,i),a.setVec(y,i)}return a}function l(r){return L(r)||k(r)}function L(r){return r.isWGS84||x(r)||W(r)||q(r)}function k(r){return r.isWebMercator}var s;(function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"})(s||(s={}));const T=R(),i=R(),p=U(),n=z();export{fr as L,Q as M,rr as O,X as R,tr as V,K as h,J as j,or as k,er as v};
