import{p as M,h9 as x,hb as q,a as k,ac as O,ha as g,hc as d,h6 as s,L as w,n as A,hn as X}from"./index.3255d2a5.js";import{c as I,r as z,b as C}from"./sphere.67ec4acb.js";function G(n){const r=n[0]*n[0]+n[4]*n[4]+n[8]*n[8],u=n[1]*n[1]+n[5]*n[5]+n[9]*n[9],t=n[2]*n[2]+n[6]*n[6]+n[10]*n[10];return Math.sqrt(Math.max(r,u,t))}function R(n,r){const u=Math.sqrt(r[0]*r[0]+r[4]*r[4]+r[8]*r[8]),t=Math.sqrt(r[1]*r[1]+r[5]*r[5]+r[9]*r[9]),c=Math.sqrt(r[2]*r[2]+r[6]*r[6]+r[10]*r[10]);return M(n,u,t,c),n}function B(n,r,u){Math.abs(n[0])>Math.abs(n[1])?M(r,0,1,0):M(r,1,0,0),x(u,n,r),q(r,r),x(r,u,n),q(u,u)}function v(n=_){return[n[0],n[1],n[2],n[3]]}function S(n=_[0],r=_[1],u=_[2],t=_[3]){return y(n,r,u,t,z.get())}function H(n,r){return y(r[0],r[1],r[2],r[3],n)}function y(n,r,u,t,c=v()){return c[0]=n,c[1]=r,c[2]=u,c[3]=t,c}function J(n,r,u){const t=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],c=Math.abs(t-1)>1e-5&&t>1e-12?1/Math.sqrt(t):1;return u[0]=r[0]*c,u[1]=r[1]*c,u[2]=r[2]*c,u[3]=-(u[0]*n[0]+u[1]*n[1]+u[2]*n[2]),u}function K(n,r,u,t=v()){const c=u[0]-r[0],a=u[1]-r[1],o=u[2]-r[2],e=n[0]-r[0],i=n[1]-r[1],b=n[2]-r[2],E=a*b-o*i,l=o*e-c*b,p=c*i-a*e,L=E*E+l*l+p*p,P=Math.abs(L-1)>1e-5&&L>1e-12?1/Math.sqrt(L):1;return t[0]=E*P,t[1]=l*P,t[2]=p*P,t[3]=-(t[0]*n[0]+t[1]*n[1]+t[2]*n[2]),t}function Q(n,r,u,t,c){const a=n.length/3;if(a<3)return!1;M(F,n[3*u],n[3*u+1],n[3*u+2]);let o=t,e=!1;for(;o<a-1&&!e;){const i=3*o;M(h,n[i],n[i+1],n[i+2]),o++,e=!X(F,h)}if(!e)return!1;for(o=Math.max(o,c),e=!1;o<a&&!e;){const i=3*o;M(N,n[i],n[i+1],n[i+2]),o++,g(T,F,h),q(T,T),g(m,h,N),q(m,m),e=!X(F,N)&&!X(h,N)&&Math.abs(s(T,m))<U}return e?(K(F,h,N,r),!0):(u!==0||t!==1||c!==2)&&Q(n,r,0,1,2)}const U=.99619469809,F=A(),h=A(),N=A(),T=A(),m=A();function nn(n,r,u){return r!==n&&H(n,r),n[3]=-s(n,u),n}function rn(n,r){return r[0]=-n[0],r[1]=-n[1],r[2]=-n[2],r[3]=-n[3],r}function un(n,r,u,t){return x(N,r,n),J(u,N,t)}function tn(n,r,u,t){return $(n,r,g(I.get(),u,r),W,t)}function cn(n,r,u){return!!k(r)&&$(n,r.origin,r.direction,Y,u)}function on(n,r,u){return $(n,r.origin,r.vector,f.NONE,u)}function en(n,r,u){return $(n,r.origin,r.vector,f.CLAMP,u)}function an(n,r){return j(n,r)>=0}function fn(n,r){const u=s(n,r.ray.direction),t=-j(n,r.ray.origin);if(u>-1e-6&&u<1e-6)return t>0;const c=t/u;return u>0?c<r.c1&&(r.c1=c):c>r.c0&&(r.c0=c),r.c0<=r.c1}function In(n,r,u){const t=O(I.get(),n,-n[3]),c=V(n,g(I.get(),r,t),I.get());return d(u,c,t),u}function Nn(n,r,u,t){const c=n,a=I.get(),o=I.get();B(c,a,o);const e=g(I.get(),u,r),i=C(a,e),b=C(o,e),E=C(c,e);return M(t,i,b,E)}function V(n,r,u){const t=O(I.get(),n,s(n,r));return g(u,r,t),u}function j(n,r){return s(n,r)+n[3]}function $(n,r,u,t,c){const a=s(n,u);if(a===0)return!1;let o=-(s(n,r)+n[3])/a;return t&f.CLAMP&&(o=w(o,0,1)),!(!(t&f.INFINITE_MIN)&&o<0||!(t&f.INFINITE_MAX)&&o>1)&&(d(c,r,O(c,u,o)),!0)}function Mn(n){return n}const _=[0,0,1,0];var f;(function(n){n[n.NONE=0]="NONE",n[n.CLAMP=1]="CLAMP",n[n.INFINITE_MIN=4]="INFINITE_MIN",n[n.INFINITE_MAX=8]="INFINITE_MAX"})(f||(f={}));const W=f.INFINITE_MIN|f.INFINITE_MAX,Y=f.INFINITE_MAX;export{H as A,an as B,S as E,y as F,fn as H,In as J,Nn as K,nn as L,un as O,rn as P,on as U,j as V,Mn as Y,J as _,R as a,Q as b,K as j,G as l,v as p,tn as q,en as w,cn as x};
